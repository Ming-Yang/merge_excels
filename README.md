# Excel/CSV文件合并工具 - PySide6版本

这是使用PySide6重构的Excel/CSV文件合并工具，具有更好的代码结构和可维护性。

## 项目结构

```
merge_excel_pyside6/
├── main.py                 # 主入口文件
├── requirements.txt        # 依赖包列表
├── README.md              # 说明文档
├── core/                  # 核心业务逻辑模块
│   ├── __init__.py
│   ├── constants.py       # 常量定义
│   ├── file_reader.py     # 文件读取功能
│   └── data_merger.py     # 数据合并功能
└── ui/                    # 用户界面模块
    ├── __init__.py
    ├── main_window.py     # 主窗口
    └── header_selection_dialog.py  # 表头选择对话框
```

## 功能特性

- 支持多种文件格式：.xlsx, .xls, .et, .csv
- 支持多文件选择和文件夹批量选择
- 异步读取文件，不阻塞UI
- 自动检测表头一致性
- 表头不一致时提供交互式选择
- 自动检测并处理重复数据
- 支持保存为Excel或CSV格式

## 安装依赖

```bash
pip install -r requirements.txt
```

## 运行程序

```bash
python main.py
```

## 使用说明

1. **选择文件**：点击"选择文件"按钮选择要合并的文件，或点击"选择路径"按钮选择包含文件的文件夹
2. **查看文件信息**：文件列表会显示文件名和行数（读取中显示"-"，失败显示"失败"）
3. **删除文件**：选中文件后点击"删除选中"按钮可以移除文件
4. **开始处理**：点击"开始处理"按钮开始合并
5. **选择表头**：如果表头不一致，会弹出对话框让您选择要使用的表头
6. **处理重复数据**：如果检测到重复数据，会询问是否去重
7. **保存结果**：选择保存位置和文件名，程序会保存合并结果

## 技术特点

- **模块化设计**：核心逻辑与UI分离，易于维护和测试
- **异步处理**：使用QThread实现文件异步读取，提升用户体验
- **类型提示**：使用类型注解提高代码可读性
- **错误处理**：完善的异常处理和用户提示

## 与原版本的区别

- 使用PySide6替代tkinter，界面更现代
- 采用模块化架构，代码结构更清晰
- 使用QThread实现真正的异步文件读取
- 更好的类型提示和代码组织

